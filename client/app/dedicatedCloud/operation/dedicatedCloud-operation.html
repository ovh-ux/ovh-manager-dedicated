<div class="dedicatedCloud-operation">

    <h2 data-translate="dedicatedCloud_tab_operation"></h2>

    <div class="text-center"
         data-ng-if="$ctrl.loading">
        <oui-spinner></oui-spinner>
    </div>

    <oui-datagrid id="operationsDatagrid"
                  data-ng-if="!$ctrl.loading"
                  data-rows-loader="$ctrl.loadOperations($config)"
                  data-row-loader="$ctrl.loadOperation($row)">
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_taskId' | translate"
                    data-property="taskId">
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_name' | translate"
                    data-property="name">
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_type' | translate">
            <span data-ng-if="$row.type"
                  data-ng-bind="('dedicatedCloud_OPERATIONS_type_' + $row.type) | translate"></span>
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_progression' | translate">
            <span data-ng-switch="$row.state">
                <span data-ng-switch-when="done"
                      data-translate="dedicatedCloud_OPERATIONS_state_done">
                </span>
                <span data-ng-switch-when="canceled"
                      data-translate="dedicatedCloud_OPERATIONS_state_canceled">
                </span>
                <span data-ng-switch-default>
                    <span data-ng-if="$row.progress"
                          data-ng-bind="('dedicatedCloud_OPERATIONS_state_' + $row.state | translate) + ' (' + $row.progress + '%)'">
                    </span>
                </span>
            </span>
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_comment' | translate"
                    data-property="description">
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_related_services' | translate">
            <span class="d-block"
                  data-ng-repeat="service in $row.relatedServices track by $index">
                <button type="button"
                        class="btn btn-link p-0 text-nowrap"
                        data-ng-if="service.action"
                        data-ng-click="service.action()"
                        data-ng-bind="service.label">
                </button>
                <span data-ng-if="!service.action"
                      data-ng-bind="service.label">
                </span>
            </span>
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_created_from' | translate"
                    data-property="createdFrom">
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_created_by' | translate"
                    data-property="createdBy">
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_date_treatment' | translate">
            <span data-ng-bind="$row.executionDate | date:'medium'"></span>
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_date_end' | translate">
            <span data-ng-bind="$row.endDate | date:'medium'"></span>
        </oui-column>
        <oui-column data-title=":: 'dedicatedCloud_OPERATIONS_date_update' | translate">
            <span data-ng-bind="$row.lastModificationDate | date:'medium'"></span>
        </oui-column>
        <extra-top>
            <label class="oui-select oui-select_m">
                <select class="oui-select__input"
                        data-ng-model="$ctrl.progressionFilter"
                        data-ng-options="p.value as p.label for p in $ctrl.progressionFilterList | orderBy: 'label'">
                    <option value=""
                            data-translate="dedicatedCloud_OPERATIONS_progression">
                    </option>
                </select>
                <i class="oui-icon oui-icon-chevron-down" aria-hidden="true"></i>
            </label>
        </extra-top>
    </oui-datagrid>
</div>
